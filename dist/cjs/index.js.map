{"version":3,"file":"index.js","names":["RefContext","createContext","BoundaryProvider","children","useState","refs","addRef","ref","push","splice","indexOf","useRef","useRefReact","context","useContext","Error","useEffect","useBoundary"],"sources":["../../src/index.tsx"],"sourcesContent":["import React, {\n  useState,\n  useRef as useRefReact,\n  useEffect,\n  createContext,\n  useContext,\n  Ref,\n  RefObject,\n  ReactNode,\n} from 'react';\n\nexport type RefContextType = {\n  addRef: (ref: Ref<unknown>) => void;\n  refs: Ref<unknown>[];\n};\n\nconst RefContext = createContext<RefContextType | null>(null);\n\nexport interface BoundaryProviderProps {\n  children?: ReactNode;\n}\nexport const BoundaryProvider: React.FC<BoundaryProviderProps> = ({\n  children,\n}) => {\n  const [refs] = useState([]);\n  function addRef(ref) {\n    refs.push(ref);\n    return () => refs.splice(refs.indexOf(ref), 1);\n  }\n\n  return (\n    <RefContext.Provider value={{ addRef, refs }}>\n      {children}\n    </RefContext.Provider>\n  );\n};\n\nexport function useRef<T>(): RefObject<T> {\n  const ref = useRefReact<T>();\n  const context = useContext(RefContext);\n  if (!context)\n    throw new Error(\n      'Missing react-ref-boundary context. Check for correct use of BoundaryProvider',\n    );\n  useEffect(() => context.addRef(ref));\n  return ref;\n}\n\nexport function useBoundary() {\n  const context = useContext(RefContext);\n  if (!context)\n    throw new Error(\n      'Missing react-ref-boundary context. Check for correct use of BoundaryProvider',\n    );\n  return { refs: context.refs };\n}\n"],"mappings":";;;;;;;;;;;AAAA;;;;;;;;;;;;;;;;;;AAgBA,IAAMA,UAAU,gBAAG,IAAAC,oBAAA,EAAqC,IAArC,CAAnB;;AAKO,IAAMC,gBAAiD,GAAG,SAApDA,gBAAoD,OAE3D;EAAA,IADJC,QACI,QADJA,QACI;;EACJ,gBAAe,IAAAC,eAAA,EAAS,EAAT,CAAf;EAAA;EAAA,IAAOC,IAAP;;EACA,SAASC,MAAT,CAAgBC,GAAhB,EAAqB;IACnBF,IAAI,CAACG,IAAL,CAAUD,GAAV;IACA,OAAO;MAAA,OAAMF,IAAI,CAACI,MAAL,CAAYJ,IAAI,CAACK,OAAL,CAAaH,GAAb,CAAZ,EAA+B,CAA/B,CAAN;IAAA,CAAP;EACD;;EAED,oBACE,gCAAC,UAAD,CAAY,QAAZ;IAAqB,KAAK,EAAE;MAAED,MAAM,EAANA,MAAF;MAAUD,IAAI,EAAJA;IAAV;EAA5B,GACGF,QADH,CADF;AAKD,CAdM;;;;AAgBA,SAASQ,MAAT,GAAmC;EACxC,IAAMJ,GAAG,GAAG,IAAAK,aAAA,GAAZ;EACA,IAAMC,OAAO,GAAG,IAAAC,iBAAA,EAAWd,UAAX,CAAhB;EACA,IAAI,CAACa,OAAL,EACE,MAAM,IAAIE,KAAJ,CACJ,+EADI,CAAN;EAGF,IAAAC,gBAAA,EAAU;IAAA,OAAMH,OAAO,CAACP,MAAR,CAAeC,GAAf,CAAN;EAAA,CAAV;EACA,OAAOA,GAAP;AACD;;AAEM,SAASU,WAAT,GAAuB;EAC5B,IAAMJ,OAAO,GAAG,IAAAC,iBAAA,EAAWd,UAAX,CAAhB;EACA,IAAI,CAACa,OAAL,EACE,MAAM,IAAIE,KAAJ,CACJ,+EADI,CAAN;EAGF,OAAO;IAAEV,IAAI,EAAEQ,OAAO,CAACR;EAAhB,CAAP;AACD"}