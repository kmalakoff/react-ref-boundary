{"version":3,"file":"react-ref-boundary.js","sources":["../../src/index.tsx"],"sourcesContent":["import React, {\n  useState,\n  useRef as useRefReact,\n  useEffect,\n  createContext,\n  useContext,\n  Ref,\n  RefObject,\n  ReactNode,\n} from 'react';\n\nexport type RefContextType = {\n  addRef: (ref: Ref<unknown>) => void;\n  refs: Ref<unknown>[];\n};\n\nconst RefContext = createContext<RefContextType | null>(null);\n\nexport interface BoundaryProviderProps {\n  children?: ReactNode;\n}\nexport const BoundaryProvider: React.FC<BoundaryProviderProps> = ({\n  children,\n}) => {\n  const [refs] = useState([]);\n  function addRef(ref) {\n    refs.push(ref);\n    return () => refs.splice(refs.indexOf(ref), 1);\n  }\n\n  return (\n    <RefContext.Provider value={{ addRef, refs }}>\n      {children}\n    </RefContext.Provider>\n  );\n};\n\nexport function useRef<T>(): RefObject<T> {\n  const ref = useRefReact<T>();\n  const context = useContext(RefContext);\n  if (!context)\n    throw new Error(\n      'Missing react-ref-boundary context. Check for correct use of BoundaryProvider',\n    );\n  useEffect(() => context.addRef(ref));\n  return ref;\n}\n\nexport function useBoundary() {\n  const context = useContext(RefContext);\n  if (!context)\n    throw new Error(\n      'Missing react-ref-boundary context. Check for correct use of BoundaryProvider',\n    );\n  return { refs: context.refs };\n}\n"],"names":["RefContext","createContext","BoundaryProvider","children","addRef","ref","refs","push","splice","indexOf","useState","React","Provider","value","useRef","useRefReact","context","useContext","Error","useEffect","useBoundary"],"mappings":";;;;;;;;;;EAAA,SAAA,iBAAA,CAAA,GAAA,EAAA,GAAA,EAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAgBA,IAAMA,UAAU,iBAAGC,mBAAa,CAAwB,IAAI,CAAC,CAAC;AAKvD,MAAMC,gBAAgB,GAAoC,SAE3D,KAAA,EAAA;EADJC,IAAAA,IAAAA,QAAQ,SAARA,QAAQ,CAAA;EAGCC,IAAAA,IAAAA,MAAM,GAAf,SAASA,MAAM,CAACC,GAAG,EAAE;EACnBC,QAAAA,IAAI,CAACC,IAAI,CAACF,GAAG,CAAC,CAAC;UACf,OAAO,WAAA;qBAAMC,IAAI,CAACE,MAAM,CAACF,IAAI,CAACG,OAAO,CAACJ,GAAG,CAAC,EAAE,CAAC,CAAC,CAAA;WAAA,CAAC;EAChD,KAAA,CAAA;EAJD,IAAA,IAAeK,GAAY,GAAA,cAAA,CAAZA,cAAQ,CAAC,EAAE,CAAC,EAAA,CAAA,CAAA,EAApBJ,IAAI,GAAII,GAAY,CAAA,CAAA,CAAhB,CAAiB;MAM5B,qBACEC,yBAAA,CAAA,aAAA,CAACX,UAAU,CAACY,QAAQ,EAAA;EAACC,QAAAA,KAAK,EAAE;EAAET,YAAAA,MAAM,EAANA,MAAM;EAAEE,YAAAA,IAAI,EAAJA,IAAI;EAAE,SAAA;EACzCH,KAAAA,EAAAA,QAAQ,CACW,CACtB;IACF;EAEK,SAASW,MAAM,GAAoB;EACxC,IAAA,IAAMT,GAAG,GAAGU,YAAW,EAAK,CAAC;EAC7B,IAAA,IAAMC,OAAO,GAAGC,gBAAU,CAACjB,UAAU,CAAC,CAAC;MACvC,IAAI,CAACgB,OAAO,EACV,MAAM,IAAIE,KAAK,CACb,+EAA+E,CAChF,CAAC;EACJC,IAAAA,eAAS,CAAC,WAAA;EAAMH,QAAAA,OAAAA,OAAO,CAACZ,MAAM,CAACC,GAAG,CAAC,CAAA;EAAA,KAAA,CAAC,CAAC;EACrC,IAAA,OAAOA,GAAG,CAAC;EACZ,CAAA;EAEM,SAASe,WAAW,GAAG;EAC5B,IAAA,IAAMJ,OAAO,GAAGC,gBAAU,CAACjB,UAAU,CAAC,CAAC;MACvC,IAAI,CAACgB,OAAO,EACV,MAAM,IAAIE,KAAK,CACb,+EAA+E,CAChF,CAAC;MACJ,OAAO;UAAEZ,IAAI,EAAEU,OAAO,CAACV,IAAI;OAAE,CAAC;EAC/B;;;;;;;;;;;;"}