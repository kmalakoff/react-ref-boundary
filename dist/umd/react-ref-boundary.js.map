{"version":3,"file":"react-ref-boundary.js","sources":["../../src/index.tsx"],"sourcesContent":["import { createContext, createElement, useContext, useEffect, useRef as useReactRef, useState } from 'react';\nimport type { FC, ReactNode, Ref, RefObject } from 'react';\n\nexport type RefContextType = {\n  addRef: (ref: Ref<unknown>) => void;\n  refs: Ref<unknown>[];\n};\n\nconst RefContext = createContext<RefContextType | undefined>(undefined);\n\nexport interface BoundaryProviderProps {\n  children?: ReactNode;\n}\nexport const BoundaryProvider: FC<BoundaryProviderProps> = ({ children }) => {\n  const state = useState([]);\n  const refs = state[0];\n\n  function addRef(ref) {\n    refs.push(ref);\n    return () => refs.splice(refs.indexOf(ref), 1);\n  }\n\n  return createElement(\n    RefContext.Provider,\n    {\n      value: {\n        addRef,\n        refs,\n      },\n    },\n    children\n  );\n};\n\nexport function useRef<T>(initialValue: T): RefObject<T> {\n  const ref = useReactRef<T>(initialValue);\n  const context = useContext(RefContext);\n  if (!context) throw new Error('react-ref-boundary: addRef not found on context. You might be missing the BoundaryProvider or have multiple instances of react-ref-boundary');\n  useEffect(() => context.addRef(ref));\n  return ref;\n}\n\nexport function useBoundary() {\n  const context = useContext(RefContext);\n  if (!context) throw new Error('Missing react-ref-boundary context. Check for correct use of BoundaryProvider');\n  return { refs: context.refs };\n}\n"],"names":["RefContext","createContext","undefined","BoundaryProvider","children","addRef","ref","refs","push","splice","indexOf","state","useState","createElement","Provider","value","useRef","initialValue","useReactRef","context","useContext","Error","useEffect","useBoundary"],"mappings":";;;;;;EAQA,IAAMA,2BAAaC,mBAA0CC,CAAAA,SAAAA,CAAAA;MAKhDC,gBAA8C,GAAA,SAAA,KAAA,EAAA;UAAGC,QAAAA,GAAAA,KAAAA,CAAAA,QAAAA;UAInDC,MAAT,GAAA,SAASA,OAAOC,GAAG,EAAA;EACjBC,QAAAA,IAAAA,CAAKC,IAAI,CAACF,GAAAA,CAAAA;UACV,OAAO,WAAA;EAAMC,YAAAA,OAAAA,IAAAA,CAAKE,MAAM,CAACF,IAAKG,CAAAA,OAAO,CAACJ,GAAM,CAAA,EAAA,CAAA,CAAA;;EAC9C,KAAA;MANA,IAAMK,KAAAA,GAAQC,eAAS,EAAE,CAAA;MACzB,IAAML,IAAAA,GAAOI,KAAK,CAAC,CAAE,CAAA;MAOrB,qBAAOE,mBAAAA,CACLb,UAAWc,CAAAA,QAAQ,EACnB;UACEC,KAAO,EAAA;cACLV,MAAAA,EAAAA,MAAAA;cACAE,IAAAA,EAAAA;EACF;OAEFH,EAAAA,QAAAA,CAAAA;EAEJ;EAEO,SAASY,OAAUC,YAAe,EAAA;EACvC,IAAA,IAAMX,MAAMY,YAAeD,CAAAA,YAAAA,CAAAA;EAC3B,IAAA,IAAME,UAAUC,gBAAWpB,CAAAA,UAAAA,CAAAA;EAC3B,IAAA,IAAI,CAACmB,OAAAA,EAAS,MAAM,IAAIE,KAAM,CAAA,6IAAA,CAAA;MAC9BC,eAAU,CAAA,WAAA;EAAMH,QAAAA,OAAAA,OAAAA,CAAQd,MAAM,CAACC,GAAAA,CAAAA;;MAC/B,OAAOA,GAAAA;EACT;EAEO,SAASiB,WAAAA,GAAAA;EACd,IAAA,IAAMJ,UAAUC,gBAAWpB,CAAAA,UAAAA,CAAAA;EAC3B,IAAA,IAAI,CAACmB,OAAAA,EAAS,MAAM,IAAIE,KAAM,CAAA,+EAAA,CAAA;MAC9B,OAAO;EAAEd,QAAAA,IAAAA,EAAMY,QAAQZ;EAAK,KAAA;EAC9B;;;;;;;;;;"}