{"version":3,"file":"react-ref-boundary.js","sources":["../../src/index.tsx"],"sourcesContent":["import { createContext, createElement, useContext, useEffect, useRef as useReactRef, useState } from 'react';\nimport type { FC, ReactNode, Ref, RefObject } from 'react';\n\nexport type RefContextType = {\n  addRef: (ref: Ref<unknown>) => void;\n  refs: Ref<unknown>[];\n};\n\nconst RefContext = createContext<RefContextType | undefined>(undefined);\n\nexport interface BoundaryProviderProps {\n  children?: ReactNode;\n}\nexport const BoundaryProvider: FC<BoundaryProviderProps> = ({ children }) => {\n  const state = useState([]);\n  const refs = state[0];\n\n  function addRef(ref) {\n    refs.push(ref);\n    return () => refs.splice(refs.indexOf(ref), 1);\n  }\n\n  return createElement(\n    RefContext.Provider,\n    {\n      value: {\n        addRef,\n        refs,\n      },\n    },\n    children\n  );\n};\n\nexport function useRef<T>(initialValue: T): RefObject<T> {\n  const ref = useReactRef<T>(initialValue);\n  const context = useContext(RefContext);\n  if (!context) throw new Error('react-ref-boundary: addRef not found on context. You might be missing the BoundaryProvider or have multiple instances of react-ref-boundary');\n  useEffect(() => context.addRef(ref));\n  return ref;\n}\n\nexport function useBoundary() {\n  const context = useContext(RefContext);\n  if (!context) throw new Error('Missing react-ref-boundary context. Check for correct use of BoundaryProvider');\n  return { refs: context.refs };\n}\n\nexport default {\n  BoundaryProvider,\n  useRef,\n  useBoundary,\n};\n"],"names":["RefContext","createContext","undefined","BoundaryProvider","children","addRef","ref","refs","push","splice","indexOf","state","useState","createElement","Provider","value","useRef","initialValue","useReactRef","context","useContext","Error","useEffect","useBoundary"],"mappings":";;;;;;EAQA,IAAMA,UAAU,iBAAGC,mBAAa,CAA6BC,SAAS,CAAC,CAAC;AAKjE,MAAMC,gBAAgB,GAA8B,SAAkB,KAAA,EAAA;EAAfC,IAAAA,IAAAA,QAAQ,SAARA,QAAQ,CAAA;EAI3DC,IAAAA,IAAAA,MAAM,GAAf,SAASA,MAAM,CAACC,GAAG,EAAE;EACnBC,QAAAA,IAAI,CAACC,IAAI,CAACF,GAAG,CAAC,CAAC;UACf,OAAO,WAAA;qBAAMC,IAAI,CAACE,MAAM,CAACF,IAAI,CAACG,OAAO,CAACJ,GAAG,CAAC,EAAE,CAAC,CAAC,CAAA;WAAA,CAAC;EAChD,KAAA,CAAA;EAND,IAAA,IAAMK,KAAK,GAAGC,cAAQ,CAAC,EAAE,CAAC,CAAC;EAC3B,IAAA,IAAML,IAAI,GAAGI,KAAK,CAAC,CAAC,CAAC,CAAC;EAOtB,IAAA,qBAAOE,mBAAa,CAClBb,UAAU,CAACc,QAAQ,EACnB;EACEC,QAAAA,KAAK,EAAE;EACLV,YAAAA,MAAM,EAANA,MAAM;EACNE,YAAAA,IAAI,EAAJA,IAAI;EACL,SAAA;OACF,EACDH,QAAQ,CACT,CAAC;IACF;EAEK,SAASY,MAAM,CAAIC,YAAe,EAAgB;EACvD,IAAA,IAAMX,GAAG,GAAGY,YAAW,CAAID,YAAY,CAAC,CAAC;EACzC,IAAA,IAAME,OAAO,GAAGC,gBAAU,CAACpB,UAAU,CAAC,CAAC;MACvC,IAAI,CAACmB,OAAO,EAAE,MAAM,IAAIE,KAAK,CAAC,6IAA6I,CAAC,CAAC;EAC7KC,IAAAA,eAAS,CAAC,WAAA;EAAMH,QAAAA,OAAAA,OAAO,CAACd,MAAM,CAACC,GAAG,CAAC,CAAA;EAAA,KAAA,CAAC,CAAC;EACrC,IAAA,OAAOA,GAAG,CAAC;EACZ,CAAA;EAEM,SAASiB,WAAW,GAAG;EAC5B,IAAA,IAAMJ,OAAO,GAAGC,gBAAU,CAACpB,UAAU,CAAC,CAAC;MACvC,IAAI,CAACmB,OAAO,EAAE,MAAM,IAAIE,KAAK,CAAC,+EAA+E,CAAC,CAAC;MAC/G,OAAO;UAAEd,IAAI,EAAEY,OAAO,CAACZ,IAAI;OAAE,CAAC;EAC/B,CAAA;AAED,cAAe;EACbJ,IAAAA,gBAAgB,EAAhBA,gBAAgB;EAChBa,IAAAA,MAAM,EAANA,MAAM;EACNO,IAAAA,WAAW,EAAXA,WAAW;GACZ;;;;;;;;;;;;;"}