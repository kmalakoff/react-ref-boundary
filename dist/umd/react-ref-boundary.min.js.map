{"version":3,"file":"react-ref-boundary.min.js","sources":["../../src/index.tsx"],"sourcesContent":["import { createContext, createElement, useContext, useEffect, useRef as useReactRef, useState } from 'react';\nimport type { FC, ReactNode, Ref, RefObject } from 'react';\n\nexport type RefContextType = {\n  addRef: (ref: Ref<unknown>) => void;\n  refs: Ref<unknown>[];\n};\n\nconst RefContext = createContext<RefContextType | undefined>(undefined);\n\nexport interface BoundaryProviderProps {\n  children?: ReactNode;\n}\nexport const BoundaryProvider: FC<BoundaryProviderProps> = ({ children }) => {\n  const state = useState([]);\n  const refs = state[0];\n\n  function addRef(ref) {\n    refs.push(ref);\n    return () => refs.splice(refs.indexOf(ref), 1);\n  }\n\n  return createElement(\n    RefContext.Provider,\n    {\n      value: {\n        addRef,\n        refs,\n      },\n    },\n    children\n  );\n};\n\nexport function useRef<T>(initialValue: T): RefObject<T> {\n  const ref = useReactRef<T>(initialValue);\n  const context = useContext(RefContext);\n  if (!context) throw new Error('react-ref-boundary: addRef not found on context. You might be missing the BoundaryProvider or have multiple instances of react-ref-boundary');\n  useEffect(() => context.addRef(ref));\n  return ref;\n}\n\nexport function useBoundary() {\n  const context = useContext(RefContext);\n  if (!context) throw new Error('Missing react-ref-boundary context. Check for correct use of BoundaryProvider');\n  return { refs: context.refs };\n}\n\nexport default {\n  BoundaryProvider,\n  useRef,\n  useBoundary,\n};\n"],"names":["RefContext","createContext","undefined","BoundaryProvider","param","children","refs","useState","createElement","Provider","value","addRef","ref","push","splice","indexOf","useRef","initialValue","useReactRef","context","useContext","Error","useEffect","useBoundary","index"],"mappings":"2RAQA,IAAMA,EAAaC,EAAAA,mBAA0CC,GAKhDC,EAA8C,SAAkBC,GAAfC,IAAAA,IAAAA,SAEtDC,EADQC,WAAS,IACJ,GAOnB,OAAOC,EAAaA,cAClBR,EAAWS,SACX,CACEC,MAAO,CACLC,OATN,SAAgBC,GAEd,OADAN,EAAKO,KAAKD,GACH,kBAAMN,EAAKQ,OAAOR,EAAKS,QAAQH,GAAM,GAC7C,EAOKN,KAAAA,IAGJD,IAIG,SAASW,EAAUC,GACxB,IAAML,EAAMM,SAAeD,GACrBE,EAAUC,aAAWpB,GAC3B,IAAKmB,EAAS,MAAM,IAAIE,MAAM,+IAE9B,OADAC,EAAAA,WAAU,WAAMH,OAAAA,EAAQR,OAAOC,EAAI,IAC5BA,CACR,CAEM,SAASW,IACd,IAAMJ,EAAUC,aAAWpB,GAC3B,IAAKmB,EAAS,MAAM,IAAIE,MAAM,iFAC9B,MAAO,CAAEf,KAAMa,EAAQb,KACxB,CAEc,IAAAkB,EAAA,CACbrB,iBAAAA,EACAa,OAAAA,EACAO,YAAAA"}