{"version":3,"file":"index.mjs","names":["React","useState","useRef","useRefReact","useEffect","createContext","useContext","RefContext","BoundaryProvider","children","refs","addRef","ref","push","splice","indexOf","context","Error","useBoundary"],"sources":["../../src/index.tsx"],"sourcesContent":["import React, {\n  useState,\n  useRef as useRefReact,\n  useEffect,\n  createContext,\n  useContext,\n  Ref,\n  RefObject,\n  ReactNode,\n} from 'react';\n\nexport type RefContextType = {\n  addRef: (ref: Ref<unknown>) => void;\n  refs: Ref<unknown>[];\n};\n\nconst RefContext = createContext<RefContextType | null>(null);\n\nexport interface BoundaryProviderProps {\n  children?: ReactNode;\n}\nexport const BoundaryProvider: React.FC<BoundaryProviderProps> = ({\n  children,\n}) => {\n  const [refs] = useState([]);\n  function addRef(ref) {\n    refs.push(ref);\n    return () => refs.splice(refs.indexOf(ref), 1);\n  }\n\n  return (\n    <RefContext.Provider value={{ addRef, refs }}>\n      {children}\n    </RefContext.Provider>\n  );\n};\n\nexport function useRef<T>(): RefObject<T> {\n  const ref = useRefReact<T>();\n  const context = useContext(RefContext);\n  if (!context)\n    throw new Error(\n      'Missing react-ref-boundary context. Check for correct use of BoundaryProvider',\n    );\n  useEffect(() => context.addRef(ref));\n  return ref;\n}\n\nexport function useBoundary() {\n  const context = useContext(RefContext);\n  if (!context)\n    throw new Error(\n      'Missing react-ref-boundary context. Check for correct use of BoundaryProvider',\n    );\n  return { refs: context.refs };\n}\n"],"mappings":"AAAA,OAAOA,KAAP,IACEC,QADF,EAEEC,MAAM,IAAIC,WAFZ,EAGEC,SAHF,EAIEC,aAJF,EAKEC,UALF,QASO,OATP;AAgBA,MAAMC,UAAU,gBAAGF,aAAa,CAAwB,IAAxB,CAAhC;AAKA,OAAO,MAAMG,gBAAiD,GAAG,CAAC;EAChEC;AADgE,CAAD,KAE3D;EACJ,MAAM,CAACC,IAAD,IAAST,QAAQ,CAAC,EAAD,CAAvB;;EACA,SAASU,MAAT,CAAgBC,GAAhB,EAAqB;IACnBF,IAAI,CAACG,IAAL,CAAUD,GAAV;IACA,OAAO,MAAMF,IAAI,CAACI,MAAL,CAAYJ,IAAI,CAACK,OAAL,CAAaH,GAAb,CAAZ,EAA+B,CAA/B,CAAb;EACD;;EAED,oBACE,oBAAC,UAAD,CAAY,QAAZ;IAAqB,KAAK,EAAE;MAAED,MAAF;MAAUD;IAAV;EAA5B,GACGD,QADH,CADF;AAKD,CAdM;AAgBP,OAAO,SAASP,MAAT,GAAmC;EACxC,MAAMU,GAAG,GAAGT,WAAW,EAAvB;EACA,MAAMa,OAAO,GAAGV,UAAU,CAACC,UAAD,CAA1B;EACA,IAAI,CAACS,OAAL,EACE,MAAM,IAAIC,KAAJ,CACJ,+EADI,CAAN;EAGFb,SAAS,CAAC,MAAMY,OAAO,CAACL,MAAR,CAAeC,GAAf,CAAP,CAAT;EACA,OAAOA,GAAP;AACD;AAED,OAAO,SAASM,WAAT,GAAuB;EAC5B,MAAMF,OAAO,GAAGV,UAAU,CAACC,UAAD,CAA1B;EACA,IAAI,CAACS,OAAL,EACE,MAAM,IAAIC,KAAJ,CACJ,+EADI,CAAN;EAGF,OAAO;IAAEP,IAAI,EAAEM,OAAO,CAACN;EAAhB,CAAP;AACD"}